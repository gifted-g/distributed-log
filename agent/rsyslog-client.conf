# /etc/rsyslog.d/99-central-forward.conf
# Forward key logs to central server over TCP
# Usage: setup_agent.sh <LOG_SERVER_IP_OR_DNS>

# Include tag with hostname (default behavior uses hostname already)
template(name="DynAuthFmt" type="string"
         string="%HOSTNAME% %syslogtag%%msg:::sp-if-no-1st-sp %msg%\n")

# Forward only selected files through imfile if needed; for simplicity we forward facilities
# AUTH and AUTHPRIV plus SYSLOG to remote
# Reliable TCP
*.* @@${LOG_SERVER}:6514;DynAuthFmt
